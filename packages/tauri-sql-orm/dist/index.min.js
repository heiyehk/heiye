!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("tauri-plugin-sql-api")):"function"==typeof define&&define.amd?define(["exports","tauri-plugin-sql-api"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).hyjs={},t.SqlDatabase)}(this,(function(t,n){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r,o=e(n),i=function(){function t(){}return t.TEXT="TEXT",t.INTEGER="INTEGER",t.REAL="REAL",t.BLOB="BLOB",t.NULL="NULL",t.BOOLEAN="BOOLEAN",t.DATE="DATE",t.DATEONLY="DATEONLY",t.TIME="TIME",t.NOW="NOW",t.UUID="UUID",t}(),c=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function u(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,u)}a((r=r.apply(t,n||[])).next())}))},u=function(t,n){var e,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(t,c)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),c=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return c},s=function(t,n,e){if(e||2===arguments.length)for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))},l=function(){function t(){}return Object.defineProperty(t,"getDB",{get:function(){return this.db},enumerable:!1,configurable:!0}),t.init=function(t,n,e){return void 0===n&&(n={}),void 0===e&&(e={}),c(this,void 0,void 0,(function(){return u(this,(function(r){return this.db=e.db,this.modelName=t,this.rawAttributes=n,[2,this]}))}))},t.create=function(t){return c(this,void 0,void 0,(function(){var n,e;return u(this,(function(r){switch(r.label){case 0:return n=Object.keys(t),e=Object.values(t),[4,this.getDB.execute("INSERT INTO ".concat(this.modelName," (").concat(n.join(", "),") VALUES (").concat(e.join(", "),");"))];case 1:return[2,r.sent()]}}))}))},t.bulkCreate=function(t){return c(this,void 0,void 0,(function(){var n,e,r,o,i;return u(this,(function(c){switch(c.label){case 0:return n=Object.keys(t[0]),e=Array(n.length).fill("?").join(", "),r=t.map((function(t){return Object.values(t)})).flat(),o=Array(t.length).fill("(".concat(e,")")).join(", "),[4,(i=this.getDB).execute.apply(i,s(["INSERT INTO ".concat(this.modelName," (").concat(n.join(", "),") VALUES ").concat(o)],a(r),!1))];case 1:return[2,c.sent()]}}))}))},t.findOne=function(t){return c(this,void 0,void 0,(function(){var n,e;return u(this,(function(r){switch(r.label){case 0:return n=Object.keys(t),e=Object.values(t),[4,this.getDB.select("SELECT * FROM ".concat(this.modelName," WHERE ").concat(n.map((function(t){return"".concat(t," = ?")})).join(" AND ")," LIMIT 1"),e)];case 1:return[2,r.sent()]}}))}))},t.findAll=function(t){return void 0===t&&(t={}),c(this,void 0,void 0,(function(){var n,e,r;return u(this,(function(o){switch(o.label){case 0:return n=Object.keys(t),e=Object.values(t),[4,(r=this.getDB).select.apply(r,s(["SELECT * FROM ".concat(this.modelName," ").concat(n.length?"WHERE ".concat(n.map((function(t){return"".concat(t," = ?")})).join(" AND ")):"")],a(e),!1))];case 1:return[2,o.sent()]}}))}))},t.sync=function(t){return c(this,void 0,void 0,(function(){var n,e,r,o=this;return u(this,(function(i){switch(i.label){case 0:return t&&t.force?[4,this.drop()]:[3,2];case 1:i.sent(),i.label=2;case 2:return n=Object.keys(this.rawAttributes),e=n.map((function(t){var n="".concat(t," ").concat(o.rawAttributes[t].type);return!1===o.rawAttributes[t].allowNull&&(n+=" NOT NULL"),o.rawAttributes[t].primaryKey&&(n+=" PRIMARY KEY"),o.rawAttributes[t].autoIncrement&&(n+=" AUTOINCREMENT"),n})),r="CREATE TABLE IF NOT EXISTS ".concat(this.modelName," (\r\n      ").concat(e.join(", \r\n      "),"\r\n)"),[4,this.getDB.execute(r)];case 3:return[2,{result:i.sent(),modelName:this.modelName}]}}))}))},t.drop=function(){return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.getDB.execute("DROP TABLE IF EXISTS ".concat(this.modelName))];case 1:return t.sent(),[2]}}))}))},t}(),f=(r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},r(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),h=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function u(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,u)}a((r=r.apply(t,n||[])).next())}))},p=function(t,n){var e,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(t,c)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},d=function(){function t(t){this.db=null,this.path="",this.init(t)}return t.prototype.init=function(t){return h(this,void 0,void 0,(function(){var n;return p(this,(function(e){switch(e.label){case 0:return n=this,[4,this.parsingPath(t)];case 1:return n.path=e.sent(),[2]}}))}))},t.prototype.getDB=function(){return h(this,void 0,void 0,(function(){var t=this;return p(this,(function(n){return[2,new Promise((function(n){var e=setInterval((function(){t.db=o.default.load(t.path),t.db&&(clearInterval(e),n(t.db))}),100)}))]}))}))},t.prototype.parsingPath=function(t){return h(this,void 0,void 0,(function(){return p(this,(function(n){return t.startsWith("sqlite:")?[2,t]:[2,"sqlite:".concat(t)]}))}))},t.prototype.define=function(t,n,e){return void 0===n&&(n={}),void 0===e&&(e={}),h(this,void 0,void 0,(function(){var r,o;return p(this,(function(i){switch(i.label){case 0:return e.modelName=t,r=e,[4,this.getDB()];case 1:return r.db=i.sent(),o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n}(l),o.init(t,n,e),[2,o]}}))}))},t.prototype.connect=function(t){return h(this,void 0,void 0,(function(){return p(this,(function(n){return this.db=this.getDB(),t&&"function"==typeof t&&t(),[2]}))}))},t.prototype.close=function(){var t;return h(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return this.path="",[4,this.db];case 1:return null===(t=n.sent())||void 0===t||t.close(),this.db=null,[2]}}))}))},t}();t.DataTypes=i,t.default=d,Object.defineProperty(t,"__esModule",{value:!0})}));
