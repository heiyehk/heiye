!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).__MirrorSandbox__=t()}(this,(function(){"use strict";var e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};return function(){function t(e,t){if(this.iframeRef=null,this.rawOptions={},this.iframeAttributes={},this.headAttributes={},!e)throw new Error("element is required");if(t){this.rawOptions=t;var r=t.head,n=t.iframe;this.iframeAttributes=n||{},this.headAttributes=r||{},this.createIframe(e,n)}}return t.prototype.createIframe=function(t,r){var n,i,o=document.createElement("iframe");try{for(var a=e(Object.keys(r)),l=a.next();!l.done;l=a.next()){var f=l.value;o.setAttribute(f,r[f])}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.iframeRef=o,t.appendChild(o),this.createIframeMarkdownBody(),this.insertIframeHead(this.headAttributes),this.injectPlugin(this.rawOptions.plugins||[])},t.prototype.createIframeMarkdownBody=function(){var e,t=((null===(e=this.iframeRef)||void 0===e?void 0:e.contentDocument)||{}).body;if(t){var r=document.createElement("div");return r.setAttribute("class","markdown-body"),r.innerHTML="markdown",t.appendChild(r),this}},t.prototype.injectPlugin=function(e){console.log(e)},t.prototype.insertIframeHead=function(t){var r,n,i,o,a,l,f,d=((null===(f=this.iframeRef)||void 0===f?void 0:f.contentDocument)||{}).head;if(d)try{for(var c=e(Object.keys(t)),u=c.next();!u.done;u=c.next()){var s=u.value;if("string"==typeof t[s])(v=document.createElement(s)).innerHTML=t[s];else try{for(var y=(i=void 0,e(t[s])),h=y.next();!h.done;h=y.next()){var m=h.value,v=document.createElement(s);if("string"==typeof m)v.innerHTML=m;else try{for(var p=(a=void 0,e(Object.keys(m))),b=p.next();!b.done;b=p.next()){var w=b.value;v.setAttribute(w,m[w])}}catch(e){a={error:e}}finally{try{b&&!b.done&&(l=p.return)&&l.call(p)}finally{if(a)throw a.error}}d.appendChild(v)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}},t.prototype.insertIframeBody=function(t){var r,n,i,o,a,l=((null===(a=this.iframeRef)||void 0===a?void 0:a.contentDocument)||{}).body;if(l){try{for(var f=e(t),d=f.next();!d.done;d=f.next()){var c=d.value;if("string"==typeof c){var u=document.createElement("script");u.innerHTML=c,l.appendChild(u)}else{var s=document.createElement("script");try{for(var y=(i=void 0,e(Object.keys(c))),h=y.next();!h.done;h=y.next()){var m=h.value;s.setAttribute(m,c[m])}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}l.appendChild(s)}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}return this}},t.prototype.loadMd=function(e){var t,r=((null===(t=this.iframeRef)||void 0===t?void 0:t.contentDocument)||{}).body;if(r){var n=r.querySelector(".markdown-body");n&&(n.innerHTML=e)}},t}()}));
