!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).__MirrorSandbox__=t()}(this,(function(){"use strict";var e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};return function(){function t(e,t){if(this.iframeRef=null,this.rawOptions={},this.headAttributes={},!e)throw new Error("element is required");if(t){this.rawOptions=t;var r=t.head,n=t.iframe;this.headAttributes=r||{},this.createIframe(e,n)}}return Object.defineProperty(t.prototype,"contentDocument",{get:function(){var e;return(null===(e=this.iframeRef)||void 0===e?void 0:e.contentDocument)||null},enumerable:!1,configurable:!0}),t.prototype.createIframe=function(t,r){var n,o,i=document.createElement("iframe");try{for(var a=e(Object.keys(r)),l=a.next();!l.done;l=a.next()){var f=l.value;r[f]?"string"==typeof r[f]?i.setAttribute(f,r[f]):console.warn("iframe ".concat(f," must be string")):console.warn("iframe ".concat(f," is required"))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}this.iframeRef=i,t.appendChild(i),this.createIframeMarkdownBody(),this.insertIframeHead(this.headAttributes),this.injectPlugin(this.rawOptions.plugins||[])},t.prototype.createIframeMarkdownBody=function(){var e=(this.contentDocument||{}).body;if(e){var t=document.createElement("div");return t.setAttribute("class","markdown-body"),t.innerHTML="markdown",e.appendChild(t),this}},t.prototype.injectPlugin=function(t){var r,n;if(t){if("Array"!==(o=t,Object.prototype.toString.call(o).slice(8,-1)))throw new Error("plugin must be array");var o;try{for(var i=e(t),a=i.next();!a.done;a=i.next()){var l=a.value;if("function"!=typeof l)throw new Error("plugin must be function");if(!this.contentDocument)throw new Error("contentDocument is null");l(this.contentDocument)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}},t.prototype.insertIframeHead=function(t){var r,n,o,i,a,l;if(t){var f=(this.contentDocument||{}).head;if(f)try{for(var c=e(Object.keys(t)),u=c.next();!u.done;u=c.next()){var d=u.value;if(t[d])if("string"==typeof t[d])(p=document.createElement(d)).innerHTML=t[d],f.appendChild(p);else try{for(var s=(o=void 0,e(t[d])),y=s.next();!y.done;y=s.next()){var h=y.value,p=document.createElement(d);if("string"==typeof h)p.innerHTML=h;else try{for(var m=(a=void 0,e(Object.keys(h))),v=m.next();!v.done;v=m.next()){var b=v.value;p.setAttribute(b,h[b])}}catch(e){a={error:e}}finally{try{v&&!v.done&&(l=m.return)&&l.call(m)}finally{if(a)throw a.error}}f.appendChild(p)}}catch(e){o={error:e}}finally{try{y&&!y.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}},t.prototype.insertIframeBody=function(t){var r,n,o,i,a=(this.contentDocument||{}).body;if(a&&t){try{for(var l=e(t),f=l.next();!f.done;f=l.next()){var c=f.value;if("string"==typeof c){var u=document.createElement("script");u.innerHTML=c,a.appendChild(u)}else{var d=document.createElement("script");try{for(var s=(o=void 0,e(Object.keys(c))),y=s.next();!y.done;y=s.next()){var h=y.value;d.setAttribute(h,c[h])}}catch(e){o={error:e}}finally{try{y&&!y.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}a.appendChild(d)}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return this}},t.prototype.loadHtml=function(e){var t=(this.contentDocument||{}).body;if(t){t.scrollTop=0;var r=t.querySelector(".markdown-body");r&&(r.innerHTML=e)}},t}()}));
